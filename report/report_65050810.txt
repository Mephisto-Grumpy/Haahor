SELECT D.DORM_ID,
       D.LATITUDE,
       D.LONGITUDE,
       D.NAME,
       F.FACILITY_NAME,
       F.ADD_ON,
       R.ROOM_TYPE,
       R.ROOM_PRICE,
       ROUND(AVG(RA.CLEANLINESS_RATE + RA.COMFORT_RATE + RA.WORTHINESS_RATE) / 3, 1) AS RATING_SCORE
FROM DORMITORY D
INNER JOIN FACILITY F ON D.DORM_ID = F.DORM_ID
INNER JOIN ROOM R ON D.DORM_ID = R.DORM_ID
INNER JOIN Review RV ON D.DORM_ID = RV.DORM_ID
INNER JOIN Rating RA ON RV.REVIEW_ID = RA.REVIEW_ID
WHERE F.FACILITY_NAME = 'ที่จอดรถ' AND F.ADD_ON = 'N' 
GROUP BY D.DORM_ID, D.LATITUDE, D.LONGITUDE, D.NAME, F.FACILITY_NAME, F.ADD_ON, R.ROOM_TYPE, R.ROOM_PRICE
HAVING ROUND(AVG(RA.CLEANLINESS_RATE + RA.COMFORT_RATE + RA.WORTHINESS_RATE) / 3, 1) >= 3.5 AND MAX(R.ROOM_PRICE) <= 5000;